---
title: "Lab08NotTeamOne"
author: "David Orozco, Ryan Tate, Arie del Valle, Anderson Mun, Ethan Schacht"
date: "March 6, 2019"
output: html_document
---

```{r, echo=FALSE,include=FALSE}
library(tidyverse)
library(data.table)
data <- read.csv("avocado.csv")
```
### Team Section
****
#### Question
****

```{r echo=FALSE}
```
#### Data
****

```{r echo=FALSE}
```
#### Conclusion
****

```{r echo=FALSE}
```
#### Data Description
****

```{r echo=FALSE}
```
### Individual Section
****

```{r echo=FALSE}
```

#### David's Section
****

```{r echo=FALSE}
tidy <- data %>% separate(Date, into =c("Year","Month","Day"), sep = "-") %>% select(-"year",-"X") %>% gather('X4046','X4225','X4770',key = 'PLUcode',value = 'amount') 
tidy$Year <- parse_integer(tidy$Year)
tidy$Month <- parse_integer(tidy$Month)
tidy$Day <- parse_integer(tidy$Day)
tidy2 <- tidy %>% filter(region == 'SanDiego'|region == 'Portland',type=='conventional')
tidy3 <- tidy %>% filter(region == 'SanDiego',type=='conventional')
tidy4 <- tidy %>% filter(region == 'Portland',type=='conventional')



ggplot() +
  geom_point(data = tidy3,mapping = aes(y= AveragePrice, x = Total.Volume),color = 'red')+
    geom_point(data = tidy4,mapping = aes(y= AveragePrice, x = Total.Volume),color = 'blue')+
  geom_smooth(data = tidy3,mapping = aes(y= AveragePrice, x = Total.Volume),size = 1.2,color = 'red',method = 'lm')+
  geom_smooth(data = tidy4,mapping = aes(y= AveragePrice, x = Total.Volume),size = 1.2,method = 'lm')+
ggtitle('Price Vs Volume for SanDiego and Portlad')


#corSandiego
cor(tidy3$AveragePrice,tidy3$Total.Volume)
#corPortland
cor(tidy4$AveragePrice,tidy4$Total.Volume)

```

* The graph above shows a strong negative correlation between average price and the total volume of avocadoes. This agrees with concepts of supply and demand. The red points are for the region of SanDiego and the blue points are for the region of Portland.The coorelation for each region is -0.7528281 and -0.7081038 respectively. 
* There are several verbs I used to tidy the avocado data. First, I used seperate and parse_interger to turn the date into usable columns of day,month, and year. I also used gather to combine the PLU codes for the avocadoes into one variable. Finally, I used filter to graph average price against the total volume in respect to a region, specifically SanDiego and Portland.

****
#### Arie's Section
****
```{r echo=FALSE}
Regions_mean <- data%>%
  select(c(region, type, AveragePrice ))%>%
  group_by(region, type)%>%
  summarise(Avg_region = mean(AveragePrice))

ggplot(Regions_mean, mapping = aes(x = Avg_region))+
  geom_density()+
  facet_wrap(~type)+
  xlab("Average Price")+
  ggtitle("Distribution of the Average Price of Conventional and Organic Avocados")
```

* Findings: This graph shows that the there is a higher distribution of conventional avocados than organic avocados. From this graph it shows that the average price amongst all regions is around $1.10 for conventional and $1.60 for organic.
* I used select to use the variables I wanted to work with. I grouped by region and type. I then took the average of each region with summarise. I created a ggplot with the new data I created. I wanted to compare the distribution of average price between conventional and organic avocados. So I used geom_density and faceted with type.

***
#### Anderson's Section
****

```{r echo=FALSE}
A <- data %>%
  group_by(region) %>%
  summarise(Avg_Bag = mean(XLarge.Bags))

ABC <- tibble(
  'Region' = c('Albany', 'Boston', 'California', 'Denver', 'Houston'),
  'AverageBag' = c(7929.747, 63596.085, 729828.975, 174429.015, 148565.278),
  'SmallBags' = c(6647.76, 58906.590, 677803.787, 55513.625, 96228.306),
  'LargeBags' = c(1153.4962, 4438.3647, 36425.8459, 118760.1229, 51372.0826),
  'XLargeBags' = c(128.48864, 251.12423, 15599.34293, 155.27006, 964.88979)
)
ABC
```

* I have created a tibble that shows the average amount of bags of avacados among five seperate regions varying from Albany to Houston. In the tibble you can see the average values of small, large and extra large bags for each region.
* To generate my findings for the tibble I used a group by function and a summarise function to find the mean of the amount of any particular bag size for each region. 


****
#### Ryan's Section
****

```{r echo=FALSE}

df1 <- as_tibble(data)

df2 <- df1 %>%
  group_by(region) %>%
  summarize(ave = mean(AveragePrice, na.rm=TRUE)) %>%
  arrange(-desc(ave))

ggplot( data = df2, aes(x = ave, y = region)) +
  geom_point( na.rm = T) +
  geom_smooth(method = "lm", na.rm = T) +
  ggtitle("Average Price per avocado by region")
```

* I tiddied my data by putting it into a tibble with as_tibble and read_csv. I then transformed my data with a group by and summarize to group the average price by region. Then I used an arrange with desc order to find the best region for avocado buying, which is Houston, or H-town as the locals call it.

* WHAT WERE YOUR FINDINGS?

****
#### Ethan's Section
****

```{r echo=FALSE}

tidy_data <- data %>%
  separate(Date, into = c("year","month","day"), sep = "-") %>%
  mutate(conventional = ifelse(type == "conventional", "1", "0")) %>%
  mutate(organic = ifelse(type == "organic", "1", "0")) %>%
  select(-X, -day)

tidy_data$month <- parse_double(tidy_data$month)
tidy_data$year <- parse_double(tidy_data$year)
tidy_data$conventional <- parse_double(tidy_data$conventional)
tidy_data$organic <- parse_double(tidy_data$organic)

avocado <- tidy_data %>%
  group_by(month) %>%
  summarise(avg_price = mean(AveragePrice),
            avg_volume = mean(`Total.Volume`)
  )

ggplot(data = avocado) +
  geom_point(mapping = aes(x = month, y = avg_price, size = avg_volume)) +
  geom_line(mapping = aes(x = month, y = avg_price)) +
  xlab("Month") +
  ylab("Average Price per Unit") +
  ggtitle("Avocado Prices over Time of Year by Volume Sold")
```

* Findings: I asked the question of how the price of avocados changes throughout the year. I tidied the data by separating date into year, month, and day and transformed the data by grouping into month and summarising average price and volume stats. This graph displays the time of year (month) against the average price of avocadoes per unit, also illustrating the volume of avocados sold at every data point by size.  The average price of avocados steadily increases throughout the year until October, when the prices begin to plummet.  We can also see that the volume sold generally decreases as the price increases, which makes sense due to supply and demand and also suggests that avocados are freshest / most in season around September and October.

#### Who did what?

* David-
* Arie-
* Anderson-
* Ethan-
* Ryan-
